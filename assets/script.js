//Fires function when document is fully loaded
$(document).ready(function () {

    // Displays current date and time to the page header when page initially loads
    var dateTime = dayjs().format("MMM D, YYYY [at] hh:mm a");
    $("#currentDay").text(dateTime);

    //Saves text content and id of each time block to local storage
    $('.saveBtn').click(function () {
        // Fetches the text content of the target time block
        var textContent = $(this).siblings().eq(1).val().trim();
        //console.log(textContent);
        // Fetches the id of the target time block
        var timeBlockId = $(this).parent('.time-block').attr('id');
        //console.log(timeBlockId);
        // Sets the text content to storage using the id as a key
        localStorage.setItem(timeBlockId, textContent);
    });

    // Fetches the current hour of the day for the purpose of comparing it against
    // time block id
    var hourOfDay = dayjs().format('[hour-]HH');
    //console.log('Current hour: ' + hourOfDay);

    //Compares the current hour of the day to each planner div and applies a class to each
    $('.time-block').each(function () {
        // Fetches time block id
        var domTimeBlock = $(this).attr('id');
        //console.log(domTimeBlock);

        // Determines what class to add to each block
        if (hourOfDay === domTimeBlock) {
            $(this).addClass('present');
        } else if (hourOfDay > domTimeBlock) {
            $(this).addClass('past');
        } else {
            $(this).addClass('future');
        }
    })

    //Prints local storage
    $('.description').each(function () {
        // Fetches stored text content
        var storedTextContent = localStorage.getItem($(this).parent('.time-block').attr('id'));
        //console.log(storedTextContent);
        // If this time block has stored text, print that data to the time block
        // This line generated by Xpert Learning Assistant, replacing an if/else statement
        $(this).text(storedTextContent ? storedTextContent : '');
    })

    // Clears local storage and text boxes when delete button is clicked
    $('.deleteBtn').click(function () {
        localStorage.clear()
        $('.description').each(function () {
            $(this).text('')
        })
    })
});